---
title: useChat Hook
description: Advanced chat interfaces with Echo's useChat hook and Vercel AI SDK integration
---

# useChat Hook

Echo provides a specialized `useChat` hook built on top of the [Vercel AI SDK `useChat`](https://ai-sdk.dev/docs/reference/ai-sdk-ui/use-chat#usechat) for advanced chat interfaces with streaming, tool usage, and state management.

```tsx {11,33,41-49}
import { EchoChatProvider, useChat } from '@merit-systems/echo-react-sdk';
import { useEchoModelProviders } from '@merit-systems/echo-react-sdk';
import { streamText, tool } from 'ai';
import { z } from 'zod';

function ChatApp() {
  const { isAuthenticated, user, balance } = useEcho();
  const { openai, anthropic } = useEchoModelProviders();
  
  const chatFn = async ({ modelMessages, uiMessages, abortSignal }) => {
    // Smart model selection based on content
    const lastMessage = uiMessages[uiMessages.length - 1]?.content || '';
    const model = lastMessage.includes('code') 
      ? await anthropic('claude-4-sonnet')
      : await openai('gpt-5');
    
    const result = await streamText({
      model,
      messages: modelMessages,
      abortSignal,
      system: `You are chatting with ${user?.name}. Be helpful and concise.`,
      tools: {
        getWeather: tool({
          description: 'Get weather for a location',
          parameters: z.object({ location: z.string() }),
          execute: async ({ location }) => `Weather in ${location}: Sunny, 72Â°F`,
        }),
      },
    });
    
    return result.toAIStreamResponse().pipeThrough(new TextDecoderStream());
  };
  
  if (!isAuthenticated) return <EchoSignIn />;
  if (balance?.balance <= 0) return <EchoTokenPurchase amount={20} />;
  
  return (
    <EchoChatProvider chatFn={chatFn}>
      <ChatInterface />
    </EchoChatProvider>
  );
}

function ChatInterface() {
  const { messages, input, handleInputChange, handleSubmit, isLoading, stop, reload, error } = useChat();
  
  return (
    <div className="chat-container">
      <div className="messages">
        {messages.map((message, index) => (
          <div key={index} className={`message ${message.role}`}>
            <strong>{message.role}:</strong> {message.content}
            {message.toolInvocations?.map((tool, i) => (
              <div key={i} className="tool-result">ðŸ”§ {tool.toolName}: {tool.result}</div>
            ))}
          </div>
        ))}
      </div>
      
      <div className="controls">
        {isLoading && <button onClick={stop}>Stop</button>}
        {error && <button onClick={reload}>Retry</button>}
      </div>
      
      <form onSubmit={handleSubmit} className="input-form">
        <input
          value={input}
          onChange={handleInputChange}
          placeholder="Ask me anything..."
          disabled={isLoading}
        />
        <button type="submit" disabled={isLoading}>
          {isLoading ? 'Sending...' : 'Send'}
        </button>
      </form>
      
      {error && <div className="error">Error: {error.message}</div>}
    </div>
  );
}
```

This comprehensive example demonstrates:
- **Smart model selection** based on message content
- **Tool integration** with weather lookup
- **Authentication guards** and balance checking  
- **Complete UI controls** (`stop`, `retry`, error handling)
- **Async model provider usage** with proper `await` syntax